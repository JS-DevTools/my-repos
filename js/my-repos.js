/*!
 * My Repos v0.1.0 (November 10th 2018)
 * 
 * https://myrepos.io/
 * 
 * @author  James Messinger (https://jamesmessinger.com)
 * @license MIT
 */
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const hash_1=require("./hash"),util_1=require("./util");class ApiClient{async fetch(t,e){let[r]=await Promise.all([await fetchWithFallback(t,e),artificialDelay()]),a=await parseResponseBody(r);if(!r.ok)throw this.createError(`${getUrl(t)} returned an HTTP ${r.status} (${r.statusText||"Error"}) response`,a);return await cacheResponse(t,r),a}async fetchArray(t,e){let r=await this.fetch(t,e);if(!Array.isArray(r))throw this.createError(`${getUrl(t)} did not return a JSON array as expected`,r);return r}async fetchObject(t,e){let r=await this.fetch(t,e);if("object"!=typeof r)throw this.createError(`${getUrl(t)} did not return a JSON object as expected`,r);if(Array.isArray(r))throw this.createError(`${getUrl(t)} returned a JSON array, but a JSON object was expected`,r);return r}createError(t,e){return new Error(t+"\n"+JSON.stringify(e,void 0,2))}}async function fetchWithFallback(t,e){let r,a;util_1.LOCAL_DEV_MODE?(r=fetchFromCache,a=fetch):(r=fetch,a=fetchFromCache);let s=await r(t,e);return s.ok?s:a(t,e)}async function fetchFromCache(t){let e={status:503,statusText:"Service Unavailable",headers:{"Content-Type":"text/plain","Content-Length":"0"},body:""},r=localStorage.getItem(getUrl(t));if(r)try{e=JSON.parse(r)}catch(t){e.body=t.message}return new Response(e.body,e)}async function cacheResponse(t,e){let r={status:e.status,statusText:e.statusText,headers:util_1.mapToPOJO(e.headers),body:await e.clone().text()};localStorage.setItem(getUrl(t),JSON.stringify(r,void 0,2))}function getUrl(t){return"string"==typeof t?t:t.url}async function parseResponseBody(t){let e;try{e=await t.clone().text()}catch(t){return}try{let t=JSON.parse(e);return"object"==typeof t?t:String(t)}catch(t){return e}}async function artificialDelay(){let t=0;hash_1.hash.options.delay&&(t=util_1.random(0,hash_1.hash.options.delay)),await new Promise(e=>setTimeout(e,t))}exports.ApiClient=ApiClient},{"./hash":12,"./util":14}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const repo_list_1=require("../repo-list/repo-list");function AccountItem(e){let{account:t}=e;return React.createElement("section",{key:t.id,className:"account"},React.createElement("header",null,React.createElement("h1",null,React.createElement("a",{href:`https://github.com/${t.login}`},t.avatar_url&&React.createElement("img",{src:t.avatar_url,className:"avatar"}),t.name))),React.createElement(AccountItemContents,Object.assign({},e)))}function AccountItemContents(e){let{account:t,toggleRepo:a}=e;return t.repos.length>0?React.createElement(repo_list_1.RepoList,{account:t,toggleRepo:a}):t.error?React.createElement("div",{className:"error"},React.createElement("div",{className:"error-message"},t.error)):t.loading?React.createElement("div",{className:"loading"},React.createElement("div",{className:"loading-message"},"Loading...")):React.createElement("div",{className:"no-repos"},React.createElement("div",{className:"empty-message"},"There are no repos to show"))}exports.AccountItem=AccountItem},{"../repo-list/repo-list":10}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const hash_1=require("../../hash"),util_1=require("../../util"),account_item_1=require("./account-item");function AccountList(t){let{accounts:e}=t;return React.createElement("main",{id:"account_list",className:util_1.accountCountCssClass(hash_1.hash.accounts)},React.createElement("div",{className:"responsive-container"},e.map(e=>React.createElement(account_item_1.AccountItem,Object.assign({account:e},t)))))}exports.AccountList=AccountList},{"../../hash":12,"../../util":14,"./account-item":2}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});class AddAccount extends React.Component{constructor(){super(...arguments),this.state={login:"",busy:!1},this.handleChange=(e=>{this.setState({login:e.target.value})}),this.handleSubmit=(async e=>{e.preventDefault(),this.state.login&&(this.setState({busy:!0}),await this.props.addAccount(this.state.login.trim()),this.setState({login:"",busy:!1}))})}render(){let{submitButtonText:e}=this.props,{login:t,busy:a}=this.state;return React.createElement("form",{className:`add-account form ${a?"busy":""}`,onSubmit:this.handleSubmit},React.createElement("dl",{className:"form-group"},React.createElement("dt",{className:"input-label"},React.createElement("label",{htmlFor:"repo_owner"},"GitHub Username")),React.createElement("dd",{className:"input-field"},React.createElement("input",{type:"text",name:"account_name",className:"form-control short",maxLength:100,autoFocus:!0,autoCapitalize:"off",autoComplete:"on",spellCheck:!1,placeholder:"GitHub Username",disabled:a,value:t,onChange:this.handleChange}))),React.createElement("button",{type:"submit",className:"btn btn-primary",disabled:a},e||"Add"))}}exports.AddAccount=AddAccount},{}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const account_list_1=require("../account-list/account-list"),first_time_1=require("../first-time/first-time"),page_header_1=require("../page-header/page-header"),state_store_1=require("./state-store");class App extends React.Component{constructor(e){super(e),state_store_1.StateStore.mixin(this)}render(){return[React.createElement(page_header_1.PageHeader,{key:"page_header",addAccount:this.addAccount}),React.createElement(account_list_1.AccountList,Object.assign({key:"account_list",removeAccount:this.removeAccount,toggleRepo:this.toggleRepo},this.state)),React.createElement(first_time_1.FirstTime,{key:"first_time",addAccount:this.addAccount})]}}exports.App=App},{"../account-list/account-list":3,"../first-time/first-time":8,"../page-header/page-header":9,"./state-store":7}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const github_1=require("../../github");async function fetchGitHubAccount(e,t){let u,r=await Promise.all([safeResolve(github_1.github.fetchAccount(e)),safeResolve(github_1.github.fetchRepos(e))]),[{result:c,error:o},{result:i,error:s}]=r;u=o?new github_1.GitHubAccount({...e,error:o.message}):c&&s?new github_1.GitHubAccount({...c,error:s.message}):c&&i?new github_1.GitHubAccount({...c,repos:i}):e,t(e.id,u)}async function safeResolve(e){let t,u;try{t=await e}catch(e){u=e}return{result:t,error:u}}exports.fetchGitHubAccount=fetchGitHubAccount},{"../../github":11}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const github_1=require("../../github"),hash_1=require("../../hash"),fetch_github_account_1=require("./fetch-github-account");class StateStore{constructor(){this.state={accounts:[]}}static mixin(t){let e=new StateStore;t.state=e.state,t.syncWithHash=e.syncWithHash.bind(t),t.addAccount=e.addAccount.bind(t),t.replaceAccount=e.replaceAccount.bind(t),t.removeAccount=e.removeAccount.bind(t),t.toggleRepo=e.toggleRepo.bind(t),setTimeout(t.syncWithHash,0),hash_1.hash.addEventListener("hashchange",t.syncWithHash)}syncWithHash(){let t=[];for(let e of hash_1.hash.accounts){let c=new github_1.GitHubAccount({login:e,name:e,loading:!0});fetch_github_account_1.fetchGitHubAccount(c,this.replaceAccount),t.push(c)}this.setState({accounts:t})}async addAccount(t){let e=this.state.accounts.find(byLogin(t));if(e)return;e=new github_1.GitHubAccount({login:t,name:t,loading:!0});let c=this.state.accounts.slice();c.push(e),this.setState({accounts:c}),await fetch_github_account_1.fetchGitHubAccount(e,this.replaceAccount)}replaceAccount(t,e){let c=this.state.accounts.slice();removeAccountByID(c,t),removeAccountByID(c,e.id),c.push(e);let s=[];for(let t of hash_1.hash.accounts){let e=c.findIndex(byLogin(t));if(e>=0){let[t]=c.splice(e,1);s.push(t)}}for(let t of c)s.push(t),hash_1.hash.addAccount(t);this.setState({accounts:s})}removeAccount(t){let e=this.state.accounts.slice(),{removed:c}=removeAccountByID(e,t);c&&(this.setState({accounts:e}),hash_1.hash.removeAccount(c))}toggleRepo(t,e,c){let s=this.state.accounts.slice(),o=s.find(byID(t)),n=o.repos.find(byID(e));n.hidden=c,this.setState({accounts:s}),hash_1.hash.toggleRepo(o,n,c)}}function removeAccountByID(t,e){let c,s=t.findIndex(byID(e));return s>=0&&(c=t.splice(s,1)[0]),{index:s,removed:c}}function byID(t){return e=>e.id===t}function byLogin(t){return t=t.trim().toLowerCase(),e=>e.login.trim().toLowerCase()===t}exports.StateStore=StateStore},{"../../github":11,"../../hash":12,"./fetch-github-account":6}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const hash_1=require("../../hash"),util_1=require("../../util"),add_account_1=require("../add-account/add-account");function FirstTime(e){return React.createElement("aside",{id:"first_time",className:util_1.accountCountCssClass(hash_1.hash.accounts)},React.createElement("div",{className:"responsive-container"},React.createElement("div",{className:"welcome-message"},React.createElement("h3",null,"Hi! ðŸ‘‹ Enter your GitHub username to get started"),React.createElement(add_account_1.AddAccount,Object.assign({submitButtonText:"Show My Repos"},e)))))}exports.FirstTime=FirstTime},{"../../hash":12,"../../util":14,"../add-account/add-account":4}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const hash_1=require("../../hash"),util_1=require("../../util"),add_account_1=require("../add-account/add-account");function PageHeader(e){return React.createElement("header",{id:"page_header",className:util_1.accountCountCssClass(hash_1.hash.accounts)},React.createElement("div",{className:"responsive-container"},React.createElement("img",{className:"logo",src:"img/logo.png",alt:"logo image"}),React.createElement("h1",null,"My GitHub Repos"),React.createElement("h2",null,"All your GitHub repos on one page"),React.createElement(add_account_1.AddAccount,Object.assign({},e))))}exports.PageHeader=PageHeader},{"../../hash":12,"../../util":14,"../add-account/add-account":4}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const hash_1=require("../../hash");function RepoList(e){let{account:t,toggleRepo:o}=e,n=t.repos.filter(byOptions);return React.createElement("ul",{className:"repo-list"},n.map(t=>React.createElement(RepoItem,Object.assign({repo:t},e))))}function RepoItem(e){let{account:t,repo:o}=e;return React.createElement("li",{key:o.id,className:"repo"},React.createElement("h2",null,React.createElement("a",{href:`https://github.com/${t.login}/${o.name}`},o.name)),o.description&&React.createElement("h3",null,o.description))}function byOptions(e){return!(e.fork&&!hash_1.hash.options.forks)}exports.RepoList=RepoList},{"../../hash":12}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const api_client_1=require("./api-client");class GitHubAccount{constructor(t={}){this.id=t.id||Math.random(),this.login=t.login||"",this.name=t.name||"",this.avatar_url=t.avatar_url||"",this.bio=t.bio||"",this.repos=t.repos||[],this.loading=Boolean(t.loading),this.error=t.error}}exports.GitHubAccount=GitHubAccount;class GitHub{constructor(){this._client=new api_client_1.ApiClient}async fetchAccount(t){let i=await this._client.fetchObject(`https://api.github.com/users/${t.login}`);if(isGitHubAccountPOJO(i))return new GitHubAccount({...i,loading:!1,repos:[]});throw this._client.createError("Invalid GitHub account:",i)}async fetchRepos(t){let i=await this._client.fetchArray(`https://api.github.com/users/${t.login}/repos`);if(isArrayOfGitHubRepoPOJO(i)){let t=[];for(let e of i)t.push({...e,hidden:!1});return t}throw this._client.createError("Invalid GitHub repo:",i)}}function isGitHubAccountPOJO(t){return"object"==typeof t&&"login"in t&&"string"==typeof t.login&&"name"in t&&"string"==typeof t.name&&"bio"in t&&"string"==typeof t.bio&&"avatar_url"in t&&"string"==typeof t.avatar_url}function isArrayOfGitHubRepoPOJO(t){return t.length>0&&"object"==typeof t[0]&&"string"==typeof t[0].name}exports.GitHub=GitHub,exports.github=new GitHub},{"./api-client":1}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const util_1=require("./util"),defaultDelay=util_1.LOCAL_DEV_MODE?1e3:0;class Hash extends EventTarget{constructor(){super(),this._accounts=new Set,this._hide=new Set,this._options={forks:!1,delay:defaultDelay},this.accounts=this._accounts,this.hide=this._hide,this.options=this._options,this._handleHashChange(),window.addEventListener("hashchange",()=>this._handleHashChange())}addAccount(e){this._accounts.add(e.login),this._updateHash()}removeAccount(e){this._accounts.delete(e.login),this._updateHash()}toggleRepo(e,t,s){s?this._hide.add(t.full_name):this._hide.delete(t.full_name),this._updateHash()}setOptions(e){Object.assign(this.options,e),this._updateHash()}toString(){let e=new URLSearchParams;this.accounts.size>0&&e.append("u",[...this.accounts].join(",")),this.hide.size>0&&e.append("hide",[...this.hide].join(",")),this.options.forks&&e.append("forks","yes"),this.options.delay&&this.options.delay!==defaultDelay&&e.append("delay",String(this.options.delay));let t=e.toString();return t=(t=t.replace(/%2C/g,",")).replace(/%2F/g,"/")}_updateHash(){location.hash=this.toString()}_handleHashChange(){if(location.hash.substr(1)!==this.toString()){let e=new URLSearchParams(location.hash.substr(1));parseStringSet(e.get("u"),this._accounts),parseStringSet(e.get("hide"),this._hide),this._options.forks=parseBoolean(e.get("forks"),this._options.forks),this._options.delay=parsePositiveInteger(e.get("delay"),this._options.delay),this.dispatchEvent(new Event("hashchange"))}}}function parseStringSet(e,t){if(t.clear(),e){let s=e.split(",");for(let e of s)(e=e.trim()).length>0&&t.add(e)}}function parseBoolean(e,t=!1){return e?["yes","true","on","ok","show"].includes(e.toLowerCase()):t}function parseNumber(e,t=0){let s=parseFloat(e);return isNaN(s)?t:s}function parseInteger(e,t=0){let s=parseNumber(e,t);return Number.isSafeInteger(s)?s:Math.round(s)}function parsePositiveInteger(e,t=0){let s=parseInteger(e,t);return s>=0?s:t}exports.Hash=Hash,exports.hash=new Hash},{"./util":14}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const app_1=require("./components/app/app");ReactDOM.render(React.createElement(app_1.App,null),document.body)},{"./components/app/app":5}],14:[function(require,module,exports){"use strict";function mapToPOJO(t){let o={};for(let[s,a]of t.entries())o[s.toString()]=a;return o}function random(t,o){return t=Math.ceil(t),o=Math.floor(o),Math.floor(Math.random()*(o-t+1))+t}function accountCountCssClass(t){switch(t.size){case 0:return"no-accounts";case 1:return"has-accounts has-one-account";default:return"has-accounts has-multiple-accounts"}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.LOCAL_DEV_MODE="localhost"===location.hostname,exports.mapToPOJO=mapToPOJO,exports.random=random,exports.accountCountCssClass=accountCountCssClass},{}]},{},[13]);
//# sourceMappingURL=my-repos.js.map
//# sourceMappingURL=my-repos.js.map